<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>In‑Page Web Browser</title>
  <style>
    :root {
      --bg: #0f172a;        /* slate-900 */
      --panel: #111827;     /* gray-900 */
      --muted: #334155;     /* slate-700 */
      --text: #e5e7eb;      /* gray-200 */
      --accent: #22c55e;    /* green-500 */
      --accent-2: #60a5fa;  /* blue-400 */
      --border: #1f2937;    /* gray-800 */
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background: linear-gradient(180deg, var(--bg), #0b1227 60%);
      color: var(--text);
      display: flex;
      flex-direction: column;
      min-height: 100%;
    }
    header {
      display: flex;
      gap: 8px;
      padding: 10px;
      background: rgba(17, 24, 39, 0.9);
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(8px);
      align-items: center;
    }
    .brand {
      font-weight: 700;
      letter-spacing: 0.2px;
      color: var(--accent);
      margin-right: 6px;
      white-space: nowrap;
    }
    .controls {
      display: flex;
      gap: 6px;
      align-items: center;
    }
    button {
      background: #0b1227;
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.04s ease, border-color 0.2s ease, background 0.2s ease;
    }
    button:hover { border-color: var(--muted); }
    button:active { transform: translateY(1px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .urlbar {
      flex: 1 1 auto;
      display: flex;
      gap: 8px;
      min-width: 160px;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #0b1227;
      color: var(--text);
      outline: none;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }
    input[type="text"]::placeholder { color: #9aa3b2; }
    input[type="text"]:focus {
      border-color: var(--accent-2);
      box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.25);
    }
    .go {
      background: linear-gradient(180deg, #2dd4bf, #22c55e);
      color: #04110a;
      font-weight: 700;
      border: none;
    }
    main {
      flex: 1 1 auto;
      min-height: 0; /* Fix for flexbox overflow */
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: #0b1227;
    }
    footer {
      font-size: 12px;
      color: #9aa3b2;
      padding: 8px 12px;
      border-top: 1px solid var(--border);
      background: rgba(17, 24, 39, 0.9);
    }
    .hint { color: #9aa3b2; }
    @media (max-width: 640px) {
      .brand { display: none; }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">In‑Page Browser</div>
    <div class="controls">
      <button id="backBtn" title="Back" disabled>←</button>
      <button id="forwardBtn" title="Forward" disabled>→</button>
      <button id="homeBtn" title="Home">⌂</button>
    </div>
    <div class="urlbar">
      <input id="urlInput" type="text" placeholder="Type a URL, e.g. example.com or https://example.com" />
      <button id="goBtn" class="go">Go</button>
    </div>
  </header>

  <main>
    <iframe id="view"
      title="In‑Page Web Browser"
      sandbox="allow-same-origin allow-scripts allow-forms"
      referrerpolicy="no-referrer"
      srcdoc="
        <!doctype html>
        <html>
        <head>
          <meta charset='utf-8'>
          <meta name='viewport' content='width=device-width, initial-scale=1'>
          <style>
            body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background:#0b1227; color:#e5e7eb; display:grid; place-items:center; height:100vh; }
            .card { text-align:center; max-width:720px; padding:32px; border:1px solid #1f2937; border-radius:16px; background:linear-gradient(180deg, #0b1227, #0a1429); box-shadow: 0 10px 40px rgba(0,0,0,0.35); }
            h1 { margin:0 0 8px 0; font-size: 22px; color:#22c55e; }
            p { margin: 8px 0; color:#9aa3b2; }
            code { background:#0f172a; border:1px solid #1f2937; padding:2px 6px; border-radius:6px; color:#e5e7eb; }
            small { color:#9aa3b2; }
          </style>
        </head>
        <body>
          <div class='card'>
            <h1>Welcome</h1>
            <p>Enter a URL above and press <code>Go</code>. This browser stays on this page.</p>
            <p><small>Note: Some sites block embedding in iframes, so they may not load here.</small></p>
          </div>
        </body>
        </html>
      ">
    </iframe>
  </main>

  <footer>
    <span class="hint">Tip: You can paste a URL and press Enter.</span>
  </footer>

  <script>
    const input = document.getElementById('urlInput');
    const goBtn = document.getElementById('goBtn');
    const backBtn = document.getElementById('backBtn');
    const forwardBtn = document.getElementById('forwardBtn');
    const homeBtn = document.getElementById('homeBtn');
    const frame = document.getElementById('view');

    const HOME_SRC = frame.getAttribute('srcdoc');

    // Simple client-side history for address-bar navigations
    const historyStack = [];
    let index = -1;

    function normalizeUrl(raw) {
      let url = raw.trim();
      if (!url) return null;

      // If it looks like a domain without scheme, prepend https://
      if (!/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(url)) {
        url = 'https://' + url;
      }
      try {
        // Validate URL
        new URL(url);
        return url;
      } catch {
        return null;
      }
    }

    function setButtons() {
      backBtn.disabled = index <= 0;
      forwardBtn.disabled = index < 0 || index >= historyStack.length - 1;
    }

    function navigate(url, push = true) {
      if (url === 'about:home') {
        frame.removeAttribute('src');
        frame.setAttribute('srcdoc', HOME_SRC);
        if (push) {
          // Trim forward history and push
          historyStack.splice(index + 1);
          historyStack.push('about:home');
          index = historyStack.length - 1;
        }
        setButtons();
        return;
      }

      // Switch iframe to external URL
      frame.removeAttribute('srcdoc');
      frame.setAttribute('src', url);

      if (push) {
        historyStack.splice(index + 1);
        historyStack.push(url);
        index = historyStack.length - 1;
      }
      setButtons();
    }

    function goFromInput() {
      const norm = normalizeUrl(input.value);
      if (!norm) {
        alert('Please enter a valid URL (e.g., example.com or https://example.com)');
        return;
      }
      navigate(norm, true);
    }

    goBtn.addEventListener('click', goFromInput);
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') goFromInput();
    });
    backBtn.addEventListener('click', () => {
      if (index > 0) {
        index -= 1;
        const url = historyStack[index];
        if (url === 'about:home') {
          navigate('about:home', false);
        } else {
          frame.removeAttribute('srcdoc');
          frame.setAttribute('src', url);
        }
        setButtons();
      }
    });
    forwardBtn.addEventListener('click', () => {
      if (index < historyStack.length - 1) {
        index += 1;
        const url = historyStack[index];
        if (url === 'about:home') {
          navigate('about:home', false);
        } else {
          frame.removeAttribute('srcdoc');
          frame.setAttribute('src', url);
        }
        setButtons();
      }
    });
    homeBtn.addEventListener('click', () => {
      input.value = '';
      navigate('about:home', true);
    });

    // Start at home
    navigate('about:home', true);
  </script>
  <!-- Add this container above the iframe -->
<div id="suggestions" style="background:#111827; padding:10px; border-bottom:1px solid #1f2937;"></div>

<script>
const suggestionsEl = document.getElementById('suggestions');

async function fetchSuggestions(query) {
  if (!query) {
    suggestionsEl.innerHTML = '';
    return;
  }
  try {
    const url = `https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json&pretty=1`;
    const res = await fetch(url);
    const data = await res.json();
    
    // Extract related topics and links
    const links = [];
    (data.RelatedTopics || []).forEach(item => {
      if (item.FirstURL && item.Text) {
        links.push({ url: item.FirstURL, title: item.Text });
      } else if (item.Topics) {
        item.Topics.forEach(sub => {
          if (sub.FirstURL && sub.Text) {
            links.push({ url: sub.FirstURL, title: sub.Text });
          }
        });
      }
    });
    
    suggestionsEl.innerHTML = links.slice(0,5).map(link => 
      `<a href="#" style="margin-right:12px; color:#60a5fa;" onclick="navigate('${link.url}'); return false;">${link.title}</a>`
    ).join('');
  } catch(e) {
    console.error(e);
    suggestionsEl.innerHTML = '<small style="color:#9aa3b2;">No suggestions available</small>';
  }
}

// Call when user types
input.addEventListener('input', () => fetchSuggestions(input.value));
</script>
  <div id="loader" style="
  display:none;
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.5);
  color:white;
  font-size:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:5;
">
  Loading...
</div>

<iframe id="view"></iframe>

<script>
const loader = document.getElementById('loader');
const frame = document.getElementById('view');

function loadInFrame(url) {
  loader.style.display = 'flex'; // show
  frame.src = url;
}

frame.onload = () => {
  loader.style.display = 'none'; // hide when loaded
};
</script>


</body>
</html>
